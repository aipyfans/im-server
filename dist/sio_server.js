!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=89)}([,,,,function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("http")},,,,,,,,,,,,function(e,t){e.exports=require("babel-polyfill")},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=s(n(77)),u=s(n(76)),a=s(n(75));function s(e){return e&&e.__esModule?e:{default:e}}function i(){return u.default.v4()}console.log("init sequelize...");var l=new o.default(a.default.database,a.default.username,a.default.password,{host:a.default.host,dialect:a.default.dialect,pool:{max:5,min:0,idle:1e4}}),c=o.default.STRING(50),f={defineModel:function(e,t){var n={};for(var u in t){var a=t[u];"object"===(void 0===a?"undefined":r(a))&&a.type?(a.allowNull=a.allowNull||!1,n[u]=a):n[u]={type:a,allowNull:!1}}return n.id={type:c,primaryKey:!0},n.createdAt={type:o.default.BIGINT,allowNull:!1},n.updatedAt={type:o.default.BIGINT,allowNull:!1},n.version={type:o.default.BIGINT,allowNull:!1},l.define(e,n,{tableName:e,timestamps:!1,hooks:{beforeValidate:function(e){var t=Date.now();e.isNewRecord?(console.log("will create entity..."+e),e.id||(e.id=i()),e.createdAt=t,e.updatedAt=t,e.version=0):(console.log("will update entity..."),e.updatedAt=t,e.version++)}}})},sync:function(){throw new Error("Cannot sync() when NODE_ENV is set to 'production'.")}},d=!0,p=!1,v=void 0;try{for(var y,m=["STRING","INTEGER","BIGINT","TEXT","DOUBLE","DATEONLY","BOOLEAN"][Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value;f[g]=o.default[g]}}catch(e){p=!0,v=e}finally{try{!d&&m.return&&m.return()}finally{if(p)throw v}}f.ID=c,f.generateId=i,t.default=f,e.exports=t.default},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e=e||"/api/",t=regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.request.path.startsWith(e)){t.next=16;break}return console.log("Process API "+n.request.method+" "+n.request.url+"..."),n.rest=function(e){n.response.type="application/json",n.response.body=e,console.log(JSON.stringify(e))},t.prev=3,t.next=6,r();case 6:t.next=14;break;case 8:t.prev=8,t.t0=t.catch(3),console.log("Process API error..."),n.response.status=400,n.response.type="application/json",n.response.body={code:t.t0.code||"internal:unknown_error",message:t.t0.message||""};case 14:t.next=18;break;case 16:return t.next=18,r();case 18:case"end":return t.stop()}},t,void 0,[[3,8]])}),n=function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(o,u){try{var a=e[o](u),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t){return n.apply(this,arguments)};var t,n},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=n(39))&&r.__esModule?r:{default:r};t.default=o.default.defineModel("users",{email:{type:o.default.STRING(100),unique:!0},passwd:o.default.STRING(100),name:o.default.STRING(100),gender:o.default.BOOLEAN}),e.exports=t.default},function(e,t,n){var r={"./User.js":71};function o(e){var t=u(e);return n(t)}function u(e){var t=r[e];if(!(t+1)){var n=new Error('Cannot find module "'+e+'".');throw n.code="MODULE_NOT_FOUND",n}return t}o.keys=function(){return Object.keys(r)},o.resolve=u,e.exports=o,o.id=72},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={dialect:"mysql",database:"db_im",username:"im",password:"im",host:"116.196.91.32",port:3306},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={dialect:"mysql",database:"db_im",username:"im",password:"im",host:"116.196.91.32",port:3306},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=n(4))&&r.__esModule?r:{default:r},u=null,a=n(74),s=n(73);console.log("Load "+a+"..."),u=a;try{o.default.statSync(s).isFile()&&(console.log("Load "+s+"..."),u=Object.assign(u,s))}catch(e){console.log("Cannot load "+s+".")}t.default=u,e.exports=t.default},function(e,t){e.exports=require("node-uuid")},function(e,t){e.exports=require("sequelize")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o(n(4));var r=o(n(39));function o(e){return e&&e.__esModule?e:{default:e}}var u={},a=n(72);a.keys().forEach(function(e){console.log(e);var t=e.substring(2,e.length-3);u[t]=a(e)}),u.sync=function(){return r.default.sync()},t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||"internal:unknown_error",this.message=n||""},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(79));function o(e){return e&&e.__esModule?e:{default:e}}var u=o(n(78)).default.User;t.default={"GET /api/users":function(){var e,t=(e=regeneratorRuntime.mark(function e(t,n){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.findAll();case 2:if(!(o=e.sent)){e.next=7;break}t.rest({users:o}),e.next=8;break;case 7:throw new r.default("users:not_found","user not found by id.");case 8:case"end":return e.stop()}},e,void 0)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,u){try{var a=t[o](u),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})});return function(e,n){return t.apply(this,arguments)}}()},e.exports=t.default},function(e,t,n){var r={"./user.js":80};function o(e){var t=u(e);return n(t)}function u(e){var t=r[e];if(!(t+1)){var n=new Error('Cannot find module "'+e+'".');throw n.code="MODULE_NOT_FOUND",n}return t}o.keys=function(){return Object.keys(r)},o.resolve=u,e.exports=o,o.id=81},function(e,t){e.exports=require("koa-router")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(82));function o(e){return e&&e.__esModule?e:{default:e}}o(n(4)),t.default=function(){var e=new r.default;return function(e){var t=n(81);t.keys().forEach(function(n){var r=t(n);!function(e,t){for(var n in t)if(n.startsWith("GET ")){var r=n.substring(4);e.get(r,t[n]),console.log("register URL mapping: GET "+r)}else n.startsWith("POST ")?(r=n.substring(5),e.post(r,t[n]),console.log("register URL mapping: POST "+r)):n.startsWith("PUT ")?(r=n.substring(4),e.put(r,t[n]),console.log("register URL mapping: PUT "+r)):n.startsWith("DELETE ")?(r=n.substring(7),e.del(r,t[n]),console.log("register URL mapping: DELETE "+r)):console.log("invalid URL: "+n)}(e,r)})}(e),e.routes()},e.exports=t.default},function(e,t){e.exports=require("socket.io")},function(e,t){e.exports=require("koa-bodyparser")},function(e,t){e.exports=require("koa")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(86)),o=l(n(85)),u=l(n(84)),a=n(5),s=l(n(83)),i=l(n(70));function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,u){try{var a=t[o](u),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}var f,d,p=new r.default;p.use((f=c(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.request.method+" "+t.request.url),e.next=3,n();case 3:case"end":return e.stop()}},e,void 0)})),function(e,t){return f.apply(this,arguments)})),p.use((d=c(regeneratorRuntime.mark(function e(t,n){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(new Date).getTime(),e.next=3,n();case 3:o=(new Date).getTime()-r,console.log("Time: "+o+"ms");case 5:case"end":return e.stop()}},e,void 0)})),function(e,t){return d.apply(this,arguments)})),p.use((0,o.default)()),p.use((0,i.default)()),p.use((0,s.default)());var v=(0,a.createServer)(p.callback());new u.default(v).on("connection",function(e){e.emit("news",{hello:"world"}),e.on("event",function(e){console.log(e)})}),t.default=v,e.exports=t.default},function(e,t,n){"use strict";var r;n(17),((r=n(87))&&r.__esModule?r:{default:r}).default.listen(3001),console.log("im server started at port 3001...")},function(e,t,n){e.exports=n(88)}]);
//# sourceMappingURL=sio_server.js.map